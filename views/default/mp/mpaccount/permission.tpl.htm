<?php
if (!TMS_APP::M('mp\permission')->can('mpsecurity','read')) {
?>
<div class='alert alert-warning'>您没有权限对公众号的权限进行设置，请联系账号管理员。</div>
<?php } else {?>
<div ng-controller='permCtrl'>
    <div class='col-md-4'> 
        <div class='form-group'>
            <div class='input-group'>
                <input type="text" class="form-control" placeholder='请输入用户的账号' ng-model='authedid'>
                <span class='input-group-btn'>
                    <button class='btn btn-primary' ng-click='addUser()'>
                        <span class='glyphicon glyphicon-plus'></span>
                    </button>
                </span>
            </div>
        </div>
        <div class='list-group'>
            <a href='#' class='list-group-item' ng-class='{active:u.selected}' ng-repeat="u in users" ng-click='selected(u)'>
                <span>{{u.authed_id}}</span>
                <button class='btn btn-default btn-xs pull-right' ng-show='selectedUser===u' ng-click='removeUser()'><span class='glyphicon glyphicon-remove'></span></button>
            </a>
        </div>
    </div>
    <div class='col-md-8'>
        <div ng-hide='selectedUser' class="alert alert-info ng-hide">
            <strong>提醒！</strong>请选择一个要设置权限的用户。
        </div>
        <table ng-show='selectedUser' class="table table-bordered table-striped ng-hide">
            <thead>
                <tr>
                    <th>权限</th>
                    <th></th>
                    <th><span>创建</span></th>
                    <th><span>查看</span></th>
                    <th><span>更新</span></th>
                    <th><span>删除</span></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>配置公众号</td>
                    <td><a href='#' ng-click="batchCheck('mpsetting','Y')">全选</a> / <a href='#' ng-click="batchCheck('mpsetting','N')">清空</a></td>
                    <td></td>
                    <td><input type="checkbox" ng-model="rights.mpsetting.read_p" ng-true-value='Y' ng-false-value='N' ng-change="update('mpsetting','read_p')"></td>
                    <td><input type="checkbox" ng-model="rights.mpsetting.update_p" ng-true-value='Y' ng-false-value='N' ng-change="update('mpsetting','update_p')"></td>
                    <td></td>
                </tr>
                <tr>
                    <td>公众号权限设置</td>
                    <td><a href='#' ng-click="batchCheck('mpsecurity','Y')">全选</a> / <a href='#' ng-click="batchCheck('mpsecurity','N')">清空</a></td>
                    <td></td>
                    <td><input type="checkbox" ng-model="rights.mpsecurity.read_p" ng-true-value='Y' ng-false-value='N' ng-change="update('mpsecurity','read_p')"></td>
                    <td><input type="checkbox" ng-model="rights.mpsecurity.update_p" ng-true-value='Y' ng-false-value='N' ng-change="update('mpsecurity','update_p')"></td>
                    <td></td>
                </tr>
                <tr>
                    <td>素材管理</td>
                    <td><a href='#' ng-click="batchCheck('matter','Y')">全选</a> / <a href='#' ng-click="batchCheck('matter','N')">清空</a></td>
                    <td></td>
                    <td><input type="checkbox" ng-model="rights.matter.read_p" ng-true-value='Y' ng-false-value='N' ng-change="update('matter','read_p')"></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>回复管理</td>
                    <td><a href='#' ng-click="batchCheck('reply','Y')">全选</a> / <a href='#' ng-click="batchCheck('reply','N')">清空</a></td>
                    <td></td>
                    <td><input type="checkbox" ng-model="rights.reply.read_p" ng-true-value='Y' ng-false-value='N' ng-change="update('reply','read_p')"></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>粉丝管理</td>
                    <td><a href='#' ng-click="batchCheck('fans','Y')">全选</a> / <a href='#' ng-click="batchCheck('fans','N')">清空</a></td>
                    <td></td>
                    <td><input type="checkbox" ng-model="rights.fans.read_p" ng-true-value='Y' ng-false-value='N' ng-change="update('fans','read_p')"></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>认证用户管理</td>
                    <td><a href='#' ng-click="batchCheck('member','Y')">全选</a> / <a href='#' ng-click="batchCheck('member','N')">清空</a></td>
                    <td></td>
                    <td><input type="checkbox" ng-model="rights.member.read_p" ng-true-value='Y' ng-false-value='N' ng-change="update('member','read_p')"></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>活动管理</td>
                    <td><a href='#' ng-click="batchCheck('activity','Y')">全选</a> / <a href='#' ng-click="batchCheck('activity','N')">清空</a></td>
                    <td></td>
                    <td><input type="checkbox" ng-model="rights.activity.read_p" ng-true-value='Y' ng-false-value='N' ng-change="update('activity','read_p')"></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>统计分析</td>
                    <td><a href='#' ng-click="batchCheck('analyze','Y')">全选</a> / <a href='#' ng-click="batchCheck('analyze','N')">清空</a></td>
                    <td></td>
                    <td><input type="checkbox" ng-model="rights.analyze.read_p" ng-true-value='Y' ng-false-value='N' ng-change="update('analyze','read_p')"></td>
                    <td></td>
                    <td></td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<?php }?>
